<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<title> 比较高效的整数求幂法 &middot; Hank&#39;s Blog </title>


<link rel="stylesheet" href="http://zhengyhn.github.io//css/slim.css">
<link rel="stylesheet" href="http://zhengyhn.github.io//css/highlight.min.css">
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Source+Code+Pro' rel='stylesheet' type='text/css'>

<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/favicon.ico">


<link href="" rel="alternate" type="application/rss+xml" title="Hank&#39;s Blog" />

</head>

<body>
  <div class="container">
    <div class="header">
  <h1 class="site-title"><a href="http://zhengyhn.github.io/">Hank&#39;s Blog</a></h1>
  <p class="site-tagline">坚持做一件事，然后静静地等待时间的回报</p>
  <div class="nav">
    <a class="nav-btn" href="#">
      <span class="ci ci-burger"></span>
    </a>
    <ul class="nav-list">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/about/">About</a></li>
       
	  <li class="spacer">&ac;</li>

      <li><a href="https://github.com/zhengyhn">Github</a></li>  
    </ul>
  </div>
</div>
    <div class="content">
      <div class="posts">
        <div class="post">
          <h2 class="post-title"><a href="http://zhengyhn.github.io/post/algorithm/quick.exp/">比较高效的整数求幂法</a></h2>
          <span class="post-date">Mar 11, 2013 </span>
          <div class="post-content">
            

<p>最近在看快速求fibonaci数列的方法，需要用到快速求幂法，于是参考了<a href="http://blog.csdn.net/hkdgjqr/article/details/5381028">这篇文章</a>
， 做下笔记。</p>

<h1 id="最直观的方法">最直观的方法</h1>

<p>如果叫我求一个整数的n次幂，我要么用pow，要么写个循环直接相乘。
比如要求：</p>

<pre><code class="language-example">5 ^ 55
</code></pre>

<p>的结果，很明显，要进行54次乘法。要知道，在目前的计算机体系架构中，乘法的计算
是非常慢的。</p>

<h1 id="效率高的求法">效率高的求法</h1>

<p>有的聪明人（不是我）就想到了减少乘法次数的方法：</p>

<pre><code class="language-example">5 ^ 2 = 5 * 5
5 ^ 4 = (5 ^ 2) * (5 ^ 2)
5 ^ 8 = (5 ^ 4) * (5 ^ 4)
5 ^ 16 = (5 ^ 8) * (5 ^ 8)
5 ^ 32 = (5 ^ 16) * (5 ^ 16)

5 ^ 55 = 5 ^ (32 + 16 + 4 + 2 + 1)
       = 5 ^ 32 * 5 ^ 16 * 5 ^ 4 * 5 ^ 2 * 5
</code></pre>

<p>现在关键是怎么求各个幂了，给出55,你怎么分解它成为32, 16, 4, 2, 1呢？</p>

<h1 id="神奇的二进制">神奇的二进制</h1>

<p>看一下55的二进制，为：</p>

<pre><code class="language-example">0011 0111
</code></pre>

<p>可以看到，二进制里面为1的就是要乘的数。于是可以想到，</p>

<pre><code class="language-example">我们从最低位开始，如果为1,则乘以这个位的2次幂，否则跳过。
</code></pre>

<p>现在问题又来的，怎么从最低位开始呢？</p>

<h1 id="倒转任意进制数">倒转任意进制数</h1>

<p>这其实是一个非常简单的算法，在我刚学C语言的时候就会了，不过当时比较笨，理解
不够透彻。上代码：</p>

<pre><code class="language-c">#include &lt;stdio.h&gt;

/* reverse a number NUM with base BASE,
 * return the reversed number in decimal. */
int reverse_num(int base, int num);

int main(int argc, char *argv[])
{
    printf(&quot;%d\n&quot;, reverse_num(10, 15));
    printf(&quot;%#x\n&quot;, reverse_num(16, 0x32));

    return 0;
}

int reverse_num(int base, int num)
{
    int new_num;

    new_num = 0;
    while (num &gt; 0) {
        new_num *= base;
        new_num += (num % base);
        num /= base;
    }
    return new_num;
}
</code></pre>

<p>而对于二进制来说，求模和除法，还可以优化！
于是我们就可以想到如何求幂了。</p>

<h1 id="较高效的整数求幂法">较高效的整数求幂法</h1>

<p>尔等码农，直接上代码吧：</p>

<pre><code class="language-c">#include &lt;stdio.h&gt;

/* calculate NUM ^ EXP，return the result */
long long qpow(int num, int exp);

int main(int argc, char *argv[])
{
    printf(&quot;%lld\n&quot;, qpow(5, 20));

    return 0;
}

long long qpow(int num, int exp)
{
    long long pow, base;

    pow = 1;
    base = num;        //long may not be able to hold
    while (exp &gt; 0) {
        if ((exp &amp; 1) == 1) {   // (exp % 2) == 1
            pow *= base;
        }
        base *= base;
        exp &gt;&gt;= 1;        // exp /= 2;
    }
    return pow;
}
</code></pre>

          </div>
        </div>
        <div class="pagination">
          <a class="btn previous " href="http://zhengyhn.github.io/post/pm/intro.org/"> Prev</a>  
          <a class="btn next " href="http://zhengyhn.github.io/post/haskell/high.order.function.org/"> Next</a> 
        </div>
      </div>
    </div>
    
    <div class="footer">
  <p>Powered by <a href="http://gohugo.io">Hugo</a>. This theme—Slim—is open sourced on <a href="https://github.com/zhe/hugo-theme-slim">Github</a>.</p>
</div>

  </div>
  <script src="http://zhengyhn.github.io//js/slim.js"></script>
  <script src="http://zhengyhn.github.io//js/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  
</body>

</html>
